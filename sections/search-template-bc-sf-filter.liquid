{% paginate search.results by section.settings.products_per_page %}
<div class="page-width container bc-sf-filter-wrapper-page">
  {% assign products_per_page = section.settings.products_per_page %}
{% paginate collection.products by products_per_page %}
<div id="bc-sf-filter-wrapper" class="have-product">
  <div id="collectionfilter">
  <div class="closeapply"><button class="btn">Apply</button></div> 
    <div id="bc-sf-filter-tree-h"></div>
  </div>
    {% comment %} TOOLBAR {% endcomment %}
  <div id="bc-sf-filter-default-toolbar">
    <div class="bc-sf-filter-default-toolbar-inner">
      <div class="bc-sf-filter-toolbar-item bc-sf-filter-toolbar-count">
        <span id="bc-sf-filter-total-product"></span>
      </div>
      <div id="bc-sf-filter-top-sorting"></div>
      <div class="bc-sf-filter-toolbar-item">
      <!--<div id="bc-sf-filter-top-display-type"></div>-->
      </div>
    </div>
</div>
{% comment %} END TOOLBAR {% endcomment %}
  <div class="background_mobile"></div>  
  <div id="bc-sf-filter-tree-mobile"></div>
  <div id="mobile_sort_by">Shop By</div>
</div>
  <div id="bc-sf-filter-tree"></div>
  <div id="bc-sf-filter-products" data-bc-sort="{{ collection.default_sort_by }}">
      {% for product in collection.products %}
         {% include 'bc-sf-filter-product-item', product: product %}
        {% endfor %}
  </div>
  <div id="bc-sf-filter-bottom-pagination" class="bc-sf-filter-bottom-pagination-default"></div>
  
  {%- if collection.metafields.Bottomdescription.Bottomdescription != blank -%}
  <div id="collectionbottomdescription">
        {{ collection.metafields.Bottomdescription.Bottomdescription }}
  </div>
{%- endif -%}
  <div id="bc-sf-filter-load-more"></div>
{% endpaginate %}
{% endpaginate %}
<script>
  // Declare bcSfFilterConfig variable
  var bcSfFilterConfig = {
    label: {
      sorting: {% assign temp = 'collections.sorting.title' | t  %} {% unless temp contains 'translation missing'  %} "{{ temp }}" {% else %} "Sorting" {% endunless %},
      sorting_best_selling: {% assign temp = 'collections.sorting.best_selling' | t %} {% unless temp contains 'translation missing'  %} "{{ temp }}" {% else %} "Best Selling" {% endunless %},
      sorting_featured: {% assign temp = 'collections.sorting.featured' | t %} {% unless temp contains 'translation missing'  %} "{{ temp }}" {% else %} "Featured" {% endunless %},
      sorting_title_ascending: {% assign temp = 'collections.sorting.az' | t %} {% unless temp contains 'translation missing'  %} "{{ temp }}" {% else %} "Alphabetically, A-Z" {% endunless %},
      sorting_title_descending: {% assign temp = 'collections.sorting.za' | t %} {% unless temp contains 'translation missing'  %} "{{ temp }}" {% else %} "Alphabetically, Z-A" {% endunless %},
      sorting_price_ascending: {% assign temp = 'collections.sorting.price_ascending' | t %} {% unless temp contains 'translation missing'  %} "{{ temp }}" {% else %} "Lowest Price" {% endunless %},
      sorting_price_descending: {% assign temp = 'collections.sorting.price_descending' | t %} {% unless temp contains 'translation missing'  %} "{{ temp }}" {% else %} "Highest Price" {% endunless %},
      sorting_date_ascending: {% assign temp = 'collections.sorting.date_ascending' | t %} {% unless temp contains 'translation missing'  %} "{{ temp }}" {% else %} "Date, Old to New" {% endunless %},
      sorting_date_descending: {% assign temp = 'collections.sorting.date_descending' | t %} {% unless temp contains 'translation missing'  %} "{{ temp }}" {% else %} "Date, New to Old" {% endunless %},
      sorting_sale_descending: {% assign temp = 'collections.sorting.sale_descending' | t %} {% unless temp contains 'translation missing'  %} "{{ temp }}" {% else %} "% Off" {% endunless %},
      sorting_relevance: {% assign temp = 'collections.sorting.relevance' | t %} {% unless temp contains 'translation missing'  %} "{{ temp }}" {% else %} "Relevance" {% endunless %},
      toolbar_viewas: "View As",
      items_with_count_one: "product",
      items_with_count_other: "Products",
    },
    label_basic: {
      sale: {{ section.settings.sale_label | json }},
      sold_out: {{ section.settings.soldout_label | json }},
      from: {{ section.settings.from | json }},
    },
    custom: {
      products_per_page: {% if products_per_page %} {{ products_per_page | json }} {% else %} 24 {% endif %},
      products_per_row: {% if section.settings.products_per_row %} {{ section.settings.products_per_row }} {% else %} 3 {% endif %},
      products_per_row_mobile: {% if section.settings.products_per_row_mobile %} {{ section.settings.products_per_row_mobile }} {% else %} 2 {% endif %},
      show_vendor: {% if section.settings.show_vendor %} {{ section.settings.show_vendor | json }} {% else %} false {% endif %},
      show_price: {% if section.settings.show_price %} {{ section.settings.show_price | json }} {% else %} false {% endif %},
      show_sale_label: {% if section.settings.show_sale_label %} {{ section.settings.show_sale_label | json }} {% else %} false {% endif %},
      show_sold_out_label: {% if section.settings.show_sold_out_label %} {{ section.settings.show_sold_out_label | json }} {% else %} false {% endif %},
      active_image_swap: {% if section.settings.active_image_swap %} {{ section.settings.active_image_swap | json }} {% else %} false {% endif %},
      show_sorting: {% if section.settings.show_sorting %} {{ section.settings.show_sorting | json }} {% else %} false {% endif %},
    }
  };

  // Declare Templates
  var bcSfFilterTemplate = {
      'soldOutClass': ' sold-out',
      'saleClass': ' on-sale',
      'soldOutLabelHtml': {% render 'bc-sf-filter-html', layout: 'soldOutLabelHtml' %},
      'saleLabelHtml': {% render 'bc-sf-filter-html', layout: 'saleLabelHtml' %},
      'tagLabelHtml': {% render 'bc-sf-filter-html', layout: 'tagLabelHtml' %},
      'vendorHtml': {% render 'bc-sf-filter-html', layout: 'vendorHtml' %},
      // Grid Template
      'productGridItemHtml': {% render 'bc-sf-filter-html', layout: 'productGridItemHtml' %},
      // For List View
      // List Template
      'productListItemHtml': {% render 'bc-sf-filter-html', layout: 'productListItemHtml' %},
      // End For List View
      // Pagination Template
      'previousActiveHtml': {% render 'bc-sf-filter-html', layout: 'previousActiveHtml' %},
      'previousDisabledHtml': {% render 'bc-sf-filter-html', layout: 'previousDisabledHtml' %},
      'nextActiveHtml': {% render 'bc-sf-filter-html', layout: 'nextActiveHtml' %},
      'nextDisabledHtml': {% render 'bc-sf-filter-html', layout: 'nextDisabledHtml' %},
      'pageItemHtml': {% render 'bc-sf-filter-html', layout: 'pageItemHtml' %},
      'pageItemSelectedHtml': {% render 'bc-sf-filter-html', layout: 'pageItemSelectedHtml' %},
      'pageItemRemainHtml': {% render 'bc-sf-filter-html', layout: 'pageItemRemainHtml' %},
      'paginateHtml': {% render 'bc-sf-filter-html', layout: 'paginateHtml' %},
      // Sorting Template
      'sortingHtml': {% render 'bc-sf-filter-html', layout: 'sortingHtml' %},
      // Show Limit Template
      'showLimitHtml': {% render 'bc-sf-filter-html', layout: 'showLimitHtml' %},
      // Breadcrumb Template
      'breadcrumbHtml': {% render 'bc-sf-filter-html', layout: 'breadcrumbHtml' %},
      'breadcrumbDivider': {% render 'bc-sf-filter-html', layout: 'breadcrumbDivider' %},
      'breadcrumbItemLink': {% render 'bc-sf-filter-html', layout: 'breadcrumbItemLink' %},
      'breadcrumbItemSelected': {% render 'bc-sf-filter-html', layout: 'breadcrumbItemSelected' %},
  };
</script>
{% schema %}
  {
    "name": "Search page",
    "settings": [
      {
        "type": "range",
        "id": "products_per_page",
        "label": "Products per page",
        "min": 2,
        "max": 50,
        "step": 1,
        "default": 24
      },
      {
        "type": "range",
        "id": "products_per_row",
        "label": "Products per row on Desktop",
        "min": 2,
        "max": 4,
        "step": 1,
        "default": 4
      },
      {
        "type": "range",
        "id": "products_per_row_mobile",
        "label": "Products per row on Mobile",
        "min": 1,
        "max": 3,
        "step": 1,
        "default": 2
      },
      {
        "type": "checkbox",
        "id": "show_vendor",
        "label": "Show product vendor",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "show_price",
        "label": "Show price",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "show_sale_label",
        "label": "Show sale label",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "show_sold_out_label",
        "label": "Show sold out label",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "active_image_swap",
        "label": "Active image swap",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "show_sorting",
        "label": "Enable collection sorting",
        "default": true
      },
      {
        "type": "text",
        "id": "soldout_label",
        "label": "Sold Out Label",
        "default": "Sold out"
      },
      {
        "type": "text",
        "id": "sale_label",
        "label": "Sale Label",
        "default": "Sale"
      },
      {
        "type": "text",
        "id": "from",
        "label": "From",
        "default": "from"
      }
    ]
  }
{% endschema %}

<script type="text/javascript">
$(document).ready(function() {
    var $cache = $('#collectionfilter');
    var vTop = $cache.offset().top - parseFloat($cache.css('margin-top').replace(/auto/, 0));
    $(window).scroll(function(event) {
        var y = $(this).scrollTop();
        if (y >= vTop) {
            $cache.addClass('filterfixed')
        } else {
            $cache.removeClass('filterfixed')
        }
    });
    $('#mobile_sort_by').addClass('filterapply');
    if ($(window).width() < 767) {
      

        $('.parentcategoryblock ul.sidemenu').hide();
        $('.parentcategoryblock.open ul.sidemenu').show();
        $('.main-page-wrapper .site-content .term-description p').insertAfter($("#shopify-section-search-template-bc-sf-filter #bc-sf-filter-bottom-pagination"));
    $('.main-page-wrapper .site-content .term-description #BrandsDescriptionPanel .BlockContent p').insertBefore($("#shopify-section-search-template-bc-sf-filter #bc-sf-filter-load-more"));
        
      
      $('.background_mobile').click(function() {
            $('#mobile_sort_by').removeClass("full_button");
            if ($('#mobile_sort_by').text() == "Shop By") {
                $('#mobile_sort_by').text("Close")
            } else {
                $('#mobile_sort_by').text("Shop By")
            }
            $('.sidebar-container').hide();
            $('#shopify-section-search-template-bc-sf-filter #bc-sf-filter-wrapper .background_mobile').removeClass("overlaey_for_sidebar_mobile")
        });
        $(".parentcategoryblock .TitleHeading").on("click", function() {
            $(".parentcategoryblock.open .sidemenu").hide('slow');
            if ($(this).hasClass('open')) {
                $(this).removeClass('open').siblings('ul').hide('slow');
                $(this).closest('.sidebarmenu_div .parentcategoryblock').removeClass('open')
            } else {
                $(".sidebarmenu_div .parentcategoryblock").siblings().removeClass('open');
                $(".sidebarmenu_div .parentcategoryblock .TitleHeading").removeClass('open');
                $(this).closest('.sidebarmenu_div .parentcategoryblock').toggleClass('open');
                $(this).toggleClass('open').siblings('ul').show('slow')
            }
        });
        $('#shopify-section-search-template-bc-sf-filter #bc-sf-filter-wrapper #mobile_sort_by').click(function() { /*$('#someone-purchased').toggleClass('hidead');*/
            if ($(this).attr("id") != 'applynow') {
                $(this).toggleClass("full_button");
                $('#shopify-section-search-template-bc-sf-filter #bc-sf-filter-wrapper .background_mobile').toggleClass("overlaey_for_sidebar_mobile");
                $('.sidebar-container').slideToggle('slow');
                if ($(this).text() == "Shop By") {
                    $(this).text("Close");
                } else {
                    $(this).text("Shop By");
                }
            }
        });
        setTimeout(function() {
            $('#shopify-section-search-template-bc-sf-filter #bc-sf-filter-tree .bc-sf-filter-option-block .bc-sf-filter-block-content').hide();
            $("#bc-sf-filter-tree #bc-sf-filter-options-wrapper .bc-sf-filter-option-block .bc-sf-filter-block-title").on("click", function() {
                $('.main-page-wrapper .site-content #shopify-section-search-template-bc-sf-filter #bc-sf-filter-tree #bc-sf-filter-options-wrapper .bc-sf-filter-option-block .bc-sf-filter-block-content').hide();
                $(this).toggleClass('open').siblings('div.bc-sf-filter-block-content').show()
            })
        }, 300)
    }
});
</script>

  <script type="text/javascript">
  $( document ).ready(function() {
        if ($(window).width() < 767){
          $(".mobiletoggle").hide();
          $(".mobiletogglebutton").click(function(){
            $(this).toggleClass('mobile_ca');
          $(this).next().toggle('slow');
          });
          $('#someone-purchased').removeClass('hidead');
          
          $('.bc-sf-filter-option-item').click(function(){
            var asas = $('.filterapply').attr("id");
            
          });
          $('#shopify-section-search-template-bc-sf-filter #bc-sf-filter-wrapper .filterapply').click(function(){
            if($(this).attr('id') === 'applynow'){
                $('#bc-sf-filter-tree-mobile-button').removeAttr("onclick");
              $('#bc-sf-filter-tree-mobile-button').click();
            }
          });
          
      $('.main-page-wrapper .site-content #shopify-section-search-template-bc-sf-filter #bc-sf-filter-tree-mobile').click(function(){
        $('#freeshipping_top').toggleClass('on');
        var cehc = $('.filterapply').attr("id");
        
        if(cehc =='mobile_sort_by'){
          $('.filterapply').attr("id", "applynow");
            $('.filterapply').text('Apply Now');
          $('#bc-sf-filter-tree-mobile-button').text('Cancel');
          $('#bc-sf-filter-tree-mobile-button').attr('onclick', 'clearAllFilterOptions(event)');
          
        }else{
       
        $('.filterapply').attr("id", "mobile_sort_by");
          $('.filterapply').text('Shop By');
          $('#bc-sf-filter-tree-mobile-button').text('Refine By');
          $('#bc-sf-filter-tree-mobile-button').removeAttr("onclick");
        }
        
       $('.main-page-wrapper .site-content #shopify-section-search-template-bc-sf-filter #bc-sf-filter-tree #bc-sf-filter-options-wrapper .bc-sf-filter-option-block-sale .bc-sf-filter-block-content').show();
   });
      $('.bc-sf-filter-block-content').css('display','none');
      window.setInterval(function(){
     
      var casdgsdn = $('#bc-sf-filter-tree-mobile-button').text();
              
      var shidepp = $('.filterapply').text();
      if(casdgsdn == "Cancel" || shidepp == "Apply Now" || shidepp == "Close"){
        $('#someone-purchased').addClass('hidead');
      } else{
        $('#someone-purchased').removeClass('hidead');
      }
        if($('.jspScrollable').length > 0){
          $('.bc-sf-filter-block-content').removeClass('jspScrollable');
        }
        
        var afads = $('.filterapply').attr("id");
        if(afads ==='applynow'){
            $('body').addClass('refinefilter');
          
          $('#bc-sf-filter-tree-mobile-button').text('Cancel');
          $('#bc-sf-filter-tree-mobile-button').attr('onclick', 'clearAllFilterOptions(event)');
        }else{
          $('body').removeClass('refinefilter');
        }
        $('.bc-sf-filter-block-content').css('display','none');
        $('.bc-sf-filter-clear-all').click(function(){
            $.removeCookie("filter");
      $('.bc-sf-filter-block-title').removeClass('open');
      });
        
        var checkC = $.cookie("filter");
        if(typeof checkC=='undefined'){
          checkC = 'bc-sf-filter-option-block.bc-sf-filter-option-block-list.bc-sf-filter-option-block-sale';
        }
        $('.'+checkC+' .bc-sf-filter-block-content').css('display','block');
        $('.'+checkC+' .bc-sf-filter-block-title').addClass('open');
        $('.bc-sf-filter-block-title h3').click(function(){
          var useit = $(this).parent().parent('div').attr('class');
          useit = useit.replace(' ','.');
          useit = useit.replace(' ','.');
          //console.log('.'+useit);
          $.cookie("filter", useit);
          $('.bc-sf-filter-block-content').css('display','none');
      $('.bc-sf-filter-block-title').removeClass('open');
          $(this).closest('.bc-sf-filter-block-content').css('display','block');
      });
      }, 1);
        }
  });
</script>